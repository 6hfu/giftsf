<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>商談スケジュール（週・日）</title>

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<style>
body {
    margin: 0;
    padding: 20px;
    font-family: "Segoe UI", "Noto Sans JP", sans-serif;
    background: #f5f7fa;
}

/* カレンダー全体 */
#calendar {
    max-width: 1200px;
    margin: auto;
    background: #fff;
    border-radius: 12px;
    padding: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,.08);
}

/* 時間軸 */
.fc-timegrid-slot-label {
    font-size: 12px;
    color: #555;
}

/* 件数イベント（重なり対策済） */
.summary-event {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    line-height: 1.2;
    border-radius: 6px;
    padding: 4px 2px;
    opacity: 0.82;           /* ← 下を透かす */
    pointer-events: none;   /* ← 操作邪魔しない */
}

/* 文字は必ず黒 */
.summary-event .fc-event-title {
    color: #111;
}

/* 通常イベント（商談） */
.fc-event {
    border-radius: 6px;
    font-size: 12px;
}
</style>
</head>

<body>
<div id="calendar"></div>

<script>
document.addEventListener('DOMContentLoaded', function () {

    const calendarEl = document.getElementById('calendar');

    /* ===== テスト用 商談データ ===== */
    const rawEvents = [
        { start: '2026-01-29T09:00', end: '2026-01-29T10:00' },
        { start: '2026-01-29T09:00', end: '2026-01-29T10:00' },
        { start: '2026-01-29T10:00', end: '2026-01-29T11:00' },
        { start: '2026-01-29T10:00', end: '2026-01-29T11:00' },
        { start: '2026-01-29T10:00', end: '2026-01-29T11:00' },
        { start: '2026-01-29T11:00', end: '2026-01-29T12:00' },
        { start: '2026-01-29T11:00', end: '2026-01-29T12:00' },
        { start: '2026-01-29T11:00', end: '2026-01-29T12:00' },
        { start: '2026-01-29T11:00', end: '2026-01-29T12:00' },
        { start: '2026-01-29T11:00', end: '2026-01-29T12:00' },
    ];

    /* ===== 件数 → 色（業務UI鉄板） ===== */
    function getColorByCount(count) {
        const colors = [
            '#E3F2FD', // 1
            '#BBDEFB', // 2
            '#90CAF9', // 3
            '#64B5F6', // 4
            '#FFF59D', // 5
            '#FFE082', // 6
            '#FFCC80', // 7
            '#FFAB91', // 8
            '#EF9A9A', // 9
            '#E53935', // 10
        ];
        return colors[Math.min(count, 10) - 1];
    }

    /* ===== 時間帯ごとに集計 ===== */
    const grouped = {};
    rawEvents.forEach(e => {
        const key = `${e.start}_${e.end}`;
        grouped[key] = grouped[key] || { start: e.start, end: e.end, count: 0 };
        grouped[key].count++;
    });

    const summaryEvents = Object.values(grouped).map(g => ({
        title: `${g.count}件`,
        start: g.start,
        end: g.end,
        display: 'block',
        backgroundColor: getColorByCount(g.count),
        borderColor: '#555',
        textColor: '#111',
        classNames: ['summary-event'],
        zIndex: 100 + g.count   // ← 多いほど前
    }));

    /* ===== カレンダー生成 ===== */
    const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'timeGridWeek',
        locale: 'ja',
        height: 'auto',

        slotMinTime: '09:00:00',
        slotMaxTime: '20:00:00',
        slotDuration: '01:00:00',

        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'timeGridWeek,timeGridDay'
        },

        events: summaryEvents
    });

    calendar.render();
});
</script>
</body>
</html>
