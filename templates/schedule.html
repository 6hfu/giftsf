<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>商談カレンダー</title>

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: #f5f7fa;
  }

  #calendar {
    max-width: 1200px;
    margin: 40px auto;
    background: white;
    padding: 16px;
    border-radius: 12px;
  }

  /* 時間枠の高さを広げる（重要） */
  .fc-timegrid-slot {
    height: 60px !important;
  }
</style>
</head>
<body>

<div id="calendar"></div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const calendarEl = document.getElementById("calendar");

  /* 仮データ（ここを実データに差し替え） */
  const events = [
    { title: "商談待ち", start: "2026-01-28T10:00:00", status: "商談待ち" },
    { title: "返答待ち", start: "2026-01-28T10:00:00", status: "返答待ち" },
    { title: "留守", start: "2026-01-28T10:00:00", status: "留守" },
    { title: "リスケ", start: "2026-01-28T11:00:00", status: "リスケ" },
    { title: "商談待ち", start: "2026-01-28T11:00:00", status: "商談待ち" }
  ];

  /* 月表示用 色 */
  const monthColors = {
    "商談待ち": "#2196F3",
    "返答待ち": "#03A9F4",
    "リスケ": "#FF9800",
    "留守": "#FFC107"
  };

  /* 時間帯ごとの件数集計 */
  const timeCountMap = {};

  events.forEach(e => {
    const hour = new Date(e.start).getHours();
    timeCountMap[hour] = (timeCountMap[hour] || 0) + 1;
  });

  function getHeatColor(count) {
    if (count <= 0) return "";
    if (count === 1) return "#E3F2FD";
    if (count === 2) return "#90CAF9";
    if (count === 3) return "#FFCC80";
    if (count === 4) return "#FF8A65";
    return "#E53935";
  }

  const calendar = new FullCalendar.Calendar(calendarEl, {
    locale: "ja",
    initialView: "dayGridMonth",
    height: "auto",
    slotMinTime: "08:00:00",
    slotMaxTime: "20:00:00",

    headerToolbar: {
      left: "prev,next today",
      center: "title",
      right: "dayGridMonth,timeGridWeek,timeGridDay"
    },

    events: events.map(e => ({
      title: e.title,
      start: e.start,
      backgroundColor: monthColors[e.status],
      borderColor: monthColors[e.status]
    })),

    /* 月表示：今まで通り */
    eventDidMount(info) {
      if (info.view.type === "dayGridMonth") return;
      info.el.style.display = "none";
    },

    /* 週・日：時間枠をヒートカラー化 */
    slotLaneDidMount(info) {
      if (!info.view.type.startsWith("timeGrid")) return;

      const hour = info.date.getHours();
      const count = timeCountMap[hour] || 0;
      const color = getHeatColor(count);

      if (color) {
        info.el.style.background = color;
      }
    }
  });

  calendar.render();
});
</script>

</body>
</html>
